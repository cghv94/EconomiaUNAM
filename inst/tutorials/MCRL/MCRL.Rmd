---
title: "Modelo cl치sico de regresi칩n lineal. Primera parte."
subtitle: "[Facultad de Econom칤a, UNAM](http://economia.unam.mx)\n"
author: "[C칠sar Gerardo Hern치ndez Vargas](https://cghv94.github.io/)\n, [Am칠rica Vianney Vel치squez Abrego](https://github.com/Vianney98)\n" 
date: "09/06/2021\n\n"
output: learnr::tutorial
runtime: shiny_prerendered
---

  ```{r setup, include=FALSE}
library(learnr)
```

## 1.쯈u칠 es el Modelo Cl치sico de Regresi칩n Lineal 

<center>
  <img src="https://www.bing.com/images/blob?bcid=Tj5dOudj7OQCcw">
  </center>
 <p style="text-align: justify">Para entender el modelo cl치sico de regresi칩n lineal (MCRL) debemos entender los supuestos en los que descansa.  <p style="text-align: justify">**1춿 Supuesto:** El modelo sigue una tendencia lineal, es decir, tiene como base los promedios de las variables y sigue esa tendencia. 
 <p style="text-align: justify">**2춿 Supuesto:** Los valores de 'X' siguen una secuancia l칩gica, pues guardan una relaci칩n directa o inversamente proporcional. 
 <p style="text-align: justify">**3춿 Supuesto:** Los residuos se comportan como en una distribuci칩n normal en donde se tiende a 0. Si los residuos no tienden a 0 se descarta el modelo,p ues deja de comportarse como una distribuci칩n normal. 
 <p style="text-align: justify">**4춿 Supuesto:** El modelo es homocedastico, pues los residuos se comportan de manera similar dentro de los datos, adem치s, la varianza tiende a 0. En caso contrario, es decir, que el modelo sea heterocedastico (Que la varianza de una variable sea distinta de las dem치s varianzas, lo que provoca que los residuos tengan diferentes varianzas y los datos tengan mucha variaci칩n), se descarta. 
 <p style="text-align: justify">**5춿 Supuesto:** Los residuos no deben tener auto correlaci칩n entre ellos. Para estp, la covarianza (relaci칩n entre las variables) debe ser igual a 0.
 <p style="text-align: justify">**6춿 Supuesto:** La covarianza entre el residuo y el eje 'X' debe ser cero. 
 <p style="text-align: justify">**7춿 Supuesto:** El n칰mero de observaciones debe ser mayor que el n칰mero de par치metros por estimar. 
 <p style="text-align: justify">**8춿 Supuesto:** La varianza 'x' debe ser mayor a 0. <p style="text-align: justify">**9춿 Supuesto:** El modelo debe estar bien especificado, es decir, a mayor comportamiento de 'x', los datos se expanden. 
 <p style="text-align: justify">**10춿 Supuesto:** No hay multicolinealidad perfecta, es decir, no existen relaciones perfectamente lineales entre las variables explicativas. 
 
## 2. 쯇ara qu칠 sirve el MCRL?
 <p style="text-align: justify"> Una de los principales usos del MCRL es el ***forecasting***. 
  <p style="text-align: justify"> El ***forecasting*** es el proceso por el cual se pueden realizar predicciones a futuro con base en un an치lisis estad칤stico con datos y tendencias observadas de manera hist칩rica.
  <p style="text-align: justify"> Para identificar un buen ***forecasting*** este debe tener:
  <p style="text-align: justify">**Tendencias:** Incrementos y/o disminuciones en nuestros datos. 
 <p style="text-align: justify">**Estacionalidad:** Periodos concretos.
 <p style="text-align: justify">**Puntos de inflexi칩n:** Cambios en los valores de los datos. 

## 3. 쮺칩mo implementar el MCRL?

<p style="text-align: justify">Existe una serie de pasos a seguir para poder conseguir implementar nuestro modelo. 
<p style="text-align: justify">**1. Definir nuestra hip칩tesis**
<p style="text-align: justify">**2. Realizar un an치lisis exploratorio de datos**
<p style="text-align: justify">**Realizar un an치lisis bivariado**
<p style="text-align: justify">**Plantear una funci칩n de regresi칩n**
<p style="text-align: justify">**Ajustar el modelo de regresi칩n**
<p style="text-align: justify">Vamos a ejemplificar lo anterior. 
<p style="text-align: center">**HIP칍TESIS**
<p style="text-align: justify">**쮼l pib de M칠xico est치 en funci칩n del PIB de EUA?**
<p style="text-align: justify">Hip칩tesis nula:
<p style="text-align: justify">*H~0~*= El PIB de M칠xico s칤 depende el PIB de EUA. 
<p style="text-align: justify">*H~1~*= El PIB de M칠xico no depende el PIB de EUA. 
<p style="text-align: center">**AN츼LISIS EXPLORATORIO DE DATOS (AN츼LISIS UNIVARIADO)**
<p style="text-align: justify">*Medidas de tendencia central*
<p style="text-align: justify">*Medidas de dispersi칩n*
<p style="text-align: justify">*Representaci칩n gr치fica*
<p style="text-align: justify">En este paso podemos utilizar Rstudio para hacer un an치lisis exploratorio de datos. 
<p style="text-align: justify">Las paqueter칤as ***tidyverse***, ***DT*** y ***moments*** nos ayudar치n a realizar este an치lisis. 
<p style="text-align: justify">Vamos a descargar las librer칤as de la siguiente forma: 

```{r}
library(tidyverse)
library(DT)
library(moments)
```
<p style="text-align: justify">El banco de datos del Banco Mundial proporciona datos sobre el
Producto Interno Bruto (PIB) de varios pa칤ses.
<p style="text-align: justify">La informaci칩n sobre valores del **PIB en d칩lares constantes** a
precios de 2010 est치 disponible en:https://databank.worldbank.org/indicator/NY.GDP.MKTP.CD/1ff4a498/Popular-Indicators
<p style="text-align: justify">Para este ejemplo,
podemos descargar los
datos del PIB de M칠xico y
el PIB de EUA de 1980 a
2018 desde la liga:
https://cghv94.github.io/
gdp.csv
<p style="text-align: justify">Para descargar la base de datos se debe hacer lo siguiente: 

```{r}
gdp <- read.csv("https://cghv94.github.io/gdp.csv")
gdp
```
<p style="text-align: justify">Podemos realizar una gr치fica del PIB de M칠xico utilizando **plot**. 


```{r}
plot(gdp$year, gdp$gdp_mx, type = "o", col = "green")
```


<p style="text-align: justify">Al igual que la gr치fica del PIB estadounidense: 
```{r}
plot(gdp$year, gdp$gdp_us, type = "o", col = "blue")
```
<p style="text-align: justify">***Medidas de tendencia central*** 
<p style="text-align: justify">**Moda:** El elemento que se repite m치s veces en la muestra.
<p style="text-align: justify">**Mediana:** Si ordenamos los elementos de la muestra del menor al mayor, la mediana es el
elemento que se encuentra a la mitad de los datos ordenados.
<p style="text-align: justify">**Media:** La suma de todos los elementos de la muestra entre el n칰mero total de
observaciones. Puede obtenerse mediante la f칩rmula:
  <center>
<img src="https://4.bp.blogspot.com/-5JZG3Q-mmWQ/TbJgVRC5_VI/AAAAAAAAAAc/g2jOEvorGjE/s1600/safsasfa.jpg">
  </center>


<p style="text-align: justify">***Frecuencias absolutas, frecuencias relativas y probabilidad cl치sica***
<p style="text-align: justify">Muestra: 1, 1, 2, 2, 2, 2, 2, 2, 3, 3, 3, 4, 4, 4, 4, 4, 5, 5, 5, 5.


| Elemento|Frecuencias absolutas = *f~j~*|Frecuencias relativas = *(f~j~)/n*| Probabilidad cl치sica|
|:-:|:-:|:-:|:-:|
|1.|2|2/20|10%|
|2.|6|6/20|30%|
|3.|3|3/20|15%|
|4.|5|5/20|25%|
|5.|4|4/20|20%|
|**Sumatoria**|20|**20/20**|100%|
|Cada uno de los elementos que aparecen en la muestra.|Cuenta del n칰mero de veces que aparece el elemento 洧녰 en la muestra.|La frecuencia absoluta del elemento 洧녰 dividida entre el n칰mero total de observaciones.|El cociente de la frecuencia absoluta del elemento 洧녰 dividida entre el n칰mero total de observaciones.|

<p style="text-align: justify">***Medidas de dispersi칩n***
<center>
  <img src="https://www.bing.com/images/blob?bcid=TnO6hbErMuUC3Q" width="750"/>
  </center>

<p style="text-align: justify">Con los datos anteriores podemos realizar el **an치lisis operatorio del PIB de M칠xico**

```{r}
resumen_mx <- rbind(M칤nimo=min(gdp$gdp_mx), M치ximo=max(gdp$gdp_mx), Mediana=median(gdp$gdp_mx), Media=mean(gdp$gdp_mx), Desviaci칩n=sd(gdp$gdp_mx), Varianza=var(gdp$gdp_mx), Asimetr칤a=skewness(gdp$gdp_mx), Curtosis=kurtosis(gdp$gdp_mx))
colnames(resumen_mx) <- "Valor"
datatable(resumen_mx)
```
<p style="text-align: justify">Con los datos anteriores podemos realizar el **an치lisis operatorio del PIB de Estados Unidos**

```{r}
resumen_us <- rbind(M칤nimo=min(gdp$gdp_us), M치ximo=max(gdp$gdp_us), Mediana=median(gdp$gdp_us), Media=mean(gdp$gdp_us), Desviaci칩n=sd(gdp$gdp_us), Varianza=var(gdp$gdp_us), Asimetr칤a=skewness(gdp$gdp_us), Curtosis=kurtosis(gdp$gdp_us))
colnames(resumen_us) <- "Valor"
datatable(resumen_us)
```
<p style="text-align: center">**DISTRIBUCI칍N NORMAL Y EMP칈RICA**
<p style="text-align: justify">Decimos que una serie de datos se distribuyen de manera normal cuando el valor del coeficiente de asimetr칤a es igual a 0 y el valor del coeficiente de curtosis es igual a 3. 
  <center>
  <img src="https://i.pinimg.com/474x/ef/5b/ee/ef5bee5da4bd9437ae3f51913dc6388f--normal-distribution-gre-math.jpg">
  </center>
<p style="text-align: justify">Cuando una serie de observaciones
cumple con estas caracter칤sticas, podemos afirmar que el 68.2% de los datos se agrupan a no m치s de una desviaci칩n est치ndar respecto al valor medio, el 95.4% de los datos a no mas de 2 deviaciones est치ndar y el 99.7% de los datos a no mas de 3 deviaciones est치ndar.   <center>
  <img src="https://tradingcenter.files.wordpress.com/2009/11/distrib-normal3.jpg">
  </center>

<p style="text-align: center">**REPRESENTACIONES GR츼FICAS DE LA DISTRIBUCI칍N**
<p style="text-align: justify">***Histograma (pol칤gono de frecuencias)***
 <center>
  <img src="https://i.stack.imgur.com/89yVK.png" width="650"/>
  </center>
<p style="text-align: justify">***Diagrama de caja (boxplot)***
 <center>
  <img src="http://dataanalyticsedge.com/wp-content/uploads/2018/05/5.jpg">
  </center>
<p style="text-align: justify">***Ojiva (frcuencias relativas acumuladas)***
 <center>
  <img src="http://4.bp.blogspot.com/_DEstOaB5TDY/SMdtoWgJuqI/AAAAAAAAAFY/g3fvnIAQdpw/s400/3.png">
  </center>
<p style="text-align: justify">***Gr치fica de dispersi칩n***
 <center>
  <img src="https://www.bing.com/images/blob?bcid=TnJNs5enROYC2Q">
  </center>

<p style="text-align: justify">Si realizamos el histograma del PIB de M칠xico se debe hacer de la siguiente forma: 
```{r}
hist(gdp$gdp_mx, col = "green")
```
<p style="text-align: justify">Y si queremos realizar el histograma del PIB de Estados Unidos se debe hacer de la siguiente forma: 
```{r}
hist(gdp$gdp_us, col = "blue")
```

<p style="text-align: center">**AN츼LISIS BIVARIADO**
<p style="text-align: justify">*a. Correlaci칩n y asociaci칩n lineal*
<p style="text-align: justify">*b. MCRL mediante m칤nimos cuadrados ordinarios*
<p style="text-align: justify">Seguimos con nuestro ejemplo. Realizamos un gr치fico de dispersi칩n entre el PIB de EUA y el PIB de M칠xico: 
```{r}
plot(gdp$gdp_us, gdp$gdp_mx, col = "purple")
```
<p style="text-align: justify">Es necesario conocer los siguientes conceptos:
 <center>
  <img src="https://www.bing.com/images/blob?bcid=The-3wGig-UCIQ" width="750">
  </center>
<p style="text-align: justify">**쮺칩mo sabemos si hay asociaci칩n lineal?**
<p style="text-align: justify">Para continuar con el c칩digo, vamos a buscar la asociaci칩n lineal de la siguiente forma: 
```{r}
asociacion_lineal <- rbind(Covarianza=cov(gdp$gdp_us, gdp$gdp_mx), Correlaci칩n=cor(gdp$gdp_us, gdp$gdp_mx), Determinaci칩n=(cor(gdp$gdp_us, gdp$gdp_mx))^2)
colnames(asociacion_lineal) <- "Valor"
datatable(asociacion_lineal)
```
<p style="text-align: justify">Podemos observar que el coeficiente de correlaci칩n es cercano a uno, as칤 que existe evidencia estad칤stica de una fuerte asociaci칩n lineal positiva entre el PIB de EAU y el PIB de M칠xico. 

<p style="text-align: center">**MODELO CL츼SICO DE REGRESI칍N LINEAL**
<p style="text-align: justify">*I. Planteamos la ecuaci칩n de la recta*
<center>
  <img src="https://www.bing.com/images/blob?bcid=TqvWlAC3LuUC7g">
  </center>

<p style="text-align: justify">*II. Replanteamos la ecuaci칩n como una funci칩n de regresi칩n lineal*
<center>
  <img src="https://www.bing.com/images/blob?bcid=TqQRU671JeUC9A">
  </center>
  
<p style="text-align: justify">*III. Sustituimos nuestras variables en la funci칩n de regresi칩n lineal*
<center>
  <img src="https://www.bing.com/images/blob?bcid=TgUFGklzWuUC7A">
  </center>
  
<p style="text-align: justify">*IV. Esta ser칤a la versi칩n final de nuestra regresi칩n*
<center>
  <img src="https://www.bing.com/images/blob?bcid=TsNSQgGaQeUCJg" width="700">
  </center>
  
<p style="text-align: center">**MODELO LINEAL SIMPLE**
<p style="text-align: justify">Vamos a realizar nuestro modelo de regresi칩n simple en R. 
<center>
  <img src="https://www.bing.com/images/blob?bcid=Tj-3dlZEtOUChQ">
  </center>
```{r}
lm(gdp_mx ~ gdp_us, data = gdp)
```
<p style="text-align: justify">**Gr치fica de dispersi칩n con regresi칩n lineal**
```{r}
plot(gdp$gdp_us, gdp$gdp_mx, col = "purple")
abline(lm(gdp_mx ~ gdp_us, data = gdp), col = "red")
```
<p style="text-align: center">**RESUMEN ESTAD칈STICO DEL MODELO LINEAL SIMPLE**
<p style="text-align: justify">Para obtener el resumen estad칤stico del modelo escribimos lo siguiente en nuestro c칩digo: 
```{r}
modelo <- lm(gdp_mx ~ gdp_us, data = gdp)
summary(modelo)
```

<p style="text-align: justify">*Gr치fica de dispersi칩n con regresi칩n lineal y suavizamiento de patrones*
<p style="text-align: justify">Por 칰ltimo, realizamos la gr치fica de dispersi칩n con la regresi칩n lineal: 
```{r}
ggplot(gdp, aes(gdp_us, gdp_mx)) + 
  geom_point() + 
  geom_smooth(method = "lm")
```
## 4. 

## 5.